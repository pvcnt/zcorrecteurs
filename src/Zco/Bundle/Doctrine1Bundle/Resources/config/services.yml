services:
    _defaults:
        autowire: true
        autoconfigure: true

    zco_doctrine1.connection:
        class: Doctrine_Connection
        factory: [Doctrine_Manager, connection]
        public: true
        arguments: ['mysql://%env(DATABASE_HOST)%/%env(DATABASE_BASE)%', '%env(DATABASE_USER)%', '%env(DATABASE_PASSWORD)%']
        calls:
          - [addListener, ['@Zco\Bundle\Doctrine1Bundle\EventListener\QueryAuditListener']]
          - [addListener, ['@Zco\Bundle\Doctrine1Bundle\EventListener\LegacyListener']]
          - [setOption, ['username', '%env(DATABASE_USER)%']]
          - [setOption, ['password', '%env(DATABASE_PASSWORD)%']]

    Doctrine_Connection:
      alias: zco_doctrine1.connection
      public: true

    Zco\Bundle\Doctrine1Bundle\EventListener\QueryAuditListener: ~

    Zco\Bundle\Doctrine1Bundle\EventListener\LegacyListener: ~

    Zco\Bundle\Doctrine1Bundle\DataCollector\DoctrineDataCollector:
        arguments: ['@Zco\Bundle\Doctrine1Bundle\EventListener\QueryAuditListener']
        tags:
            - { name: data_collector, template: "ZcoDoctrine1Bundle::collector", id: doctrine1 }

    Zco\Bundle\Doctrine1Bundle\EventListener\PaginationListener:
        tags:
            - { name: kernel.event_subscriber }

    Zco\Bundle\Doctrine1Bundle\Migrations\MigrationGenerator: ~

    Zco\Bundle\Doctrine1Bundle\Command\:
        resource: '../../Command/*'
        tags: ['console.command']

    Zco\Bundle\Doctrine1Bundle\Command\MigrationsDiffCommand:
        arguments:
            $cacheDir: '%kernel.cache_dir%/zco_doctrine1'

    Zco\Bundle\Doctrine1Bundle\Form\DoctrineOrmTypeGuesser:
        tags:
            - { name: form.type_guesser }
        
    Zco\Bundle\Doctrine1Bundle\Form\Type\EntityType:
        tags:
            - { name: form.type, alias: entity }

    Zco\Bundle\Doctrine1Bundle\Migrations\Configuration:
        arguments: ["%kernel.root_dir%/../data/migrations", "@service_container"]